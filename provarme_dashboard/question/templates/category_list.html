{% extends "base.html" %}
{% load static %}
{% load mptt_tags %}
{% block styles %}
	<link type="text/css" rel="stylesheet" href="{% static 'assets/css/theme-default/libs/DataTables/jquery.dataTables.css' %}"/>
	<link type="text/css" rel="stylesheet" href="{% static 'assets/vendors/sweetalert/sweetalert.css' %}" />
{% endblock styles %}
{% block content %}
	<!-- BEGIN CONTENT-->
	<div id="content">
		<section class="style-default-bright">
			<div class="section-header">
				<h2 class="text-primary">Categorias</h2>
				<span class="pull-right"><a href="{% url 'category_add' %}" class="btn ink-reaction btn-primary"><i class="fa fa-plus"></i> Nova Categoria</a></span>
			</div>
			<div class="section-body">

				<!-- BEGIN DATATABLE 1 -->
				<div class="row">
					<div class="col-md-8">
						<article class="margin-bottom-xxl">
							<p class="lead">
								As categorias são utilizadas para catalogar questões para que no momento da criação de um simulado, o usuário possa selecionar as matérias ou assuntos das questões do simulado.
							</p>
						</article>
					</div><!--end .col -->
				</div><!--end .row -->
				<div class="row">
					<div class="col-lg-12">
						<div class="table-responsive">
							<table id="categories" class="table table-striped table-hover">
								<thead>
									<tr>
										<th>Descrição</th>
										<th class="no-sort">Ações</th>
									</tr>
								</thead>
								<tbody>
									{% for category in categories %}
										<tr>

											<td width="70%">
												{{ category|truncatechars:100 }}
											</td>

											<td width="30%">
												<a href="{% url 'category_edit' category.slug %}" class="btn btn-flat" data-toggle="tooltip" data-title="Editar Categoria {{ category.description }}"><i class="fa fa-edit"></i></a>
												<a href="#" class="btn btn-flat delete-category" data-toggle="tooltip" data-title="Excluir Categoria {{ category.description }}" data-url="{% url 'category_delete' category.pk %}"><i class="fa fa-trash"></i></a>
											</td>

										</tr>
									{% endfor %}
								</tbody>
							</table>
						</div><!--end .table-responsive -->
					</div><!--end .col -->
				</div><!--end .row -->
				<!-- END DATATABLE 1 -->
			</div><!--end .section-body -->
		</section>
	</div><!--end #content-->
	<!-- END CONTENT -->
{% endblock content %}
{% block scripts %}
	<script src="{% static 'assets/js/libs/DataTables/jquery.dataTables.min.js' %}"></script>
	<script src="{% static 'assets/vendors/sweetalert/sweetalert.min.js' %}"></script>
	<!-- <script src="{% static 'assets/js/libs/DataTables/extensions/ColVis/js/dataTables.colVis.min.js' %}"></script>
	<script src="{% static 'assets/js/libs/DataTables/extensions/TableTools/js/dataTables.tableTools.min.js' %}"></script>
	<script src="{% static 'assets/js/core/demo/DemoTableDynamic.js' %}"></script> -->
	<script>
		$(document).ready(function () {
			$("#categories").DataTable({
				"columnDefs": [{
					"targets": 'no-sort',
					"orderable": true,
					"rowReorder": true,

				}]
			});

			$(".delete-category").click(function () {
				var url = $(this).attr("data-url");
				deleteCategory(url);
			});

			function deleteCategory(url) {
				swal({
					title: "Tem certeza?",
					text: "Você irá excluir essa categoria e todas as categorias e questões relacionadas a ela serão apagadas!",
					type: "warning",
					showCancelButton: true,
					cancelButtonText: "Cancelar",
					confirmButtonColor: "#DD6B55",
					confirmButtonText: "Sim, excluir!",
					closeOnConfirm: false
				},
				function(isConfirm){
					if (isConfirm) {
						window.location.href = url;
					}
				});
			};
		});
	</script>
{% endblock scripts %}
